<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Venda de Cursos</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> <!-- Font Awesome -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <style>
        body {
            background-color: #f4f4f4;
        }
        .toast {
            display: none;
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4caf50;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 1000;
        }
        .swiper-slide {
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }
        .course-item {
            display: flex;
            flex-direction: column; /* Alinha os elementos verticalmente */
            height: 100%; /* Faz com que o card ocupe toda a altura do slide */
        }
        .course-content {
            flex-grow: 1; /* Faz com que o conteúdo do curso ocupe o espaço restante */
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="bg-white shadow-md p-4 relative">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold">Meu E-commerce de Cursos</h1>
            <div class="flex-grow flex items-center mx-4">
                <button id="menu-button" class="mr-2">
                    <i class="fas fa-bars"></i>
                </button>
                <input type="text" id="search-input" placeholder="Buscar curso..." class="border rounded p-2 flex-grow" />
            </div>
            <div class="relative">
                <button id="cart-button" class="text-gray-700">
                    <i class="fas fa-shopping-cart fa-lg"></i>
                    <span id="cart-badge" class="absolute top-0 right-0 bg-red-500 text-white rounded-full text-xs px-1">0</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Seções de Cursos -->
    <div class="container mx-auto p-6">
        <div id="development-section" class="mb-10">
            <h2 class="text-3xl font-bold text-center mb-6">Cursos de Desenvolvimento</h2>
            <div class="swiper-container">
                <div class="swiper-wrapper" id="development-courses">
                    <!-- Cursos de Desenvolvimento serão renderizados aqui -->
                </div>
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
            </div>
        </div>

        <div id="design-section" class="mb-10">
            <h2 class="text-3xl font-bold text-center mb-6">Cursos de Design</h2>
            <div class="swiper-container">
                <div class="swiper-wrapper" id="design-courses">
                    <!-- Cursos de Design serão renderizados aqui -->
                </div>
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
            </div>
        </div>

        <div id="marketing-section" class="mb-10">
            <h2 class="text-3xl font-bold text-center mb-6">Cursos de Marketing</h2>
            <div class="swiper-container">
                <div class="swiper-wrapper" id="marketing-courses">
                    <!-- Cursos de Marketing serão renderizados aqui -->
                </div>
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast">
        <i class="fas fa-check-circle"></i> Curso adicionado ao carrinho com sucesso!
    </div>

    <!-- Carrinho Modal -->
    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden justify-center items-center">
        <div class="bg-white rounded-lg p-6 w-7/12 h-9/10 max-w-md mx-auto">
            <h2 class="text-xl font-bold mb-4">Carrinho de Compras</h2>
            <div id="cart-items" class="mb-4"></div>
            <div id="empty-cart-message" class="text-center text-gray-600 hidden">Adicione um curso ao carrinho!</div>
            <div id="duplicate-course-message" class="text-red-500 hidden">O curso já se encontra no carrinho.</div>
            <div class="flex justify-between mt-4">
                <button id="checkout-button" class="bg-green-500 text-white py-1 px-2 rounded hidden">Ir para Checkout</button>
                <button id="clear-cart-button" class="mt-4 bg-red-500 text-white py-1 px-2 rounded">Esvaziar Carrinho</button>
            </div>
            <button id="close-modal" class="mt-4 text-red-500">Fechar</button>
        </div>
    </div>

    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script>
        let cart = [];
        let courses = []; // Inicializa a variável courses

        // Inicializa o Swiper
        const swiperInstances = [];

        function initializeSwiper(container) {
            return new Swiper(container, {
                slidesPerView: 4, // Número de cursos visíveis
                spaceBetween: 30, // Espaço entre os cursos
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
            });
        }

        async function loadCoursesByCategory() {
            try {
                const response = await fetch('cursos.json');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                courses = data; // Armazena os cursos na variável global

                // Renderiza os cursos por categoria
                renderCoursesByCategory();
            } catch (error) {
                console.error('Houve um problema com a requisição Fetch:', error);
            }
        }

        function renderCoursesByCategory() {
            const developmentCourses = courses.filter(course => course.categoria === 'Desenvolvimento');
            const designCourses = courses.filter(course => course.categoria === 'Design');
            const marketingCourses = courses.filter(course => course.categoria === 'Marketing');

            renderCourses(developmentCourses, 'development-courses');
            renderCourses(designCourses, 'design-courses');
            renderCourses(marketingCourses, 'marketing-courses');
        }

        function renderCourses(coursesToRender, containerId) {
            const coursesContainer = document.getElementById(containerId);
            coursesContainer.innerHTML = ''; // Limpa o conteúdo anterior

            coursesToRender.forEach(course => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide'; // Classe necessária para o Swiper
                slide.innerHTML = `
                    <div class="bg-white shadow-lg rounded-lg p-4 course-item" data-category="${course.categoria}">
                        <img src="${course.imagem}" alt="${course.nome}" class="w-full h-48 object-cover rounded-t-lg" />
                        <div class="course-content flex-grow"> <!-- Adiciona flex-grow para ocupar o espaço restante -->
                            <h3 class="text-xl font-semibold mt-2">${course.nome}</h3>
                            <p class="text-gray-600">${course.descricao}</p>
                        </div>
                        <h4 class="text-lg font-bold mt-2">${course.preco} Escudos</h4>
                        <button class="cta-button mt-4 bg-green-500 text-white py-2 px-4 rounded" onclick="adicionarAoCarrinho('${course.nome}', ${course.preco})">Adicionar ao Carrinho</button>
                    </div>
                `;
                coursesContainer.appendChild(slide); // Adiciona o slide ao container
            });

            // Inicializa o Swiper para o container atual
            const swiper = initializeSwiper(coursesContainer.parentNode);
            swiper.update(); // Atualiza o Swiper para reconhecer os novos slides
        }

        function searchCourses() {
            const searchInput = document.getElementById('search-input').value.toLowerCase();
            const filteredCourses = courses.filter(course => course.nome.toLowerCase().includes(searchInput));
            renderCoursesByCategory(filteredCourses);
        }

        document.getElementById('search-input').addEventListener('input', searchCourses);
        document.getElementById('cart-button').addEventListener('click', () => {
            document.getElementById('cart-modal').classList.toggle('hidden');
        });

        document.getElementById('close-modal').addEventListener('click', () => {
            document.getElementById('cart-modal').classList.add('hidden');
        });

        document.getElementById('checkout-button').addEventListener('click', () => {
            alert('Redirecionando para a página de checkout...');
        });

        document.getElementById('clear-cart-button').addEventListener('click', () => {
            cart = [];
            atualizarCarrinho();
        });

        function adicionarAoCarrinho(nomeCurso, precoCurso) {
            const cursoExistente = cart.find(item => item.nome === nomeCurso);
            if (cursoExistente) {
                mostrarToast('duplicate-course-message');
                return;
            }
            cart.push({ nome: nomeCurso, preco: precoCurso });
            atualizarCarrinho();
            mostrarToast('toast');
        }

        function mostrarToast(toastId) {
            const toast = document.getElementById(toastId);
            toast.classList.remove('hidden');
            setTimeout(() => {
                toast.classList.add('hidden');
            }, 3000);
        }

        function atualizarCarrinho() {
            const cartBadge = document.getElementById('cart-badge');
            const cartItems = document.getElementById('cart-items');
            const emptyCartMessage = document.getElementById('empty-cart-message');
            const checkoutButton = document.getElementById('checkout-button');
            const clearCartButton = document.getElementById('clear-cart-button');

            cartBadge.innerText = cart.length;

            cartItems.innerHTML = '';
            if (cart.length === 0) {
                emptyCartMessage.classList.remove('hidden');
                checkoutButton.classList.add('hidden');
                clearCartButton.classList.add('hidden');
            } else {
                emptyCartMessage.classList.add('hidden');
                checkoutButton.classList.remove('hidden');
                clearCartButton.classList.remove('hidden');
                cart.forEach((item, index) => {
                    cartItems.innerHTML += `<div class="flex items-center mb-2">
                        <img src="${item.imagem}" alt="${item.nome}" class="h-16 w-16 object-cover rounded mr-2">
                        <div class="flex-1">
                            <span class="block font-semibold">${item.nome}</span>
                            <span class="block text-gray-600">${item.preco} Escudos</span>
                        </div>
                        <button class="text-red-500" onclick="removerDoCarrinho(${index})">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>`;
                });
            }
        }

        function removerDoCarrinho(index) {
            cart.splice(index, 1);
            atualizarCarrinho();
        }

        // Chama a função para carregar os cursos por categoria
        loadCoursesByCategory();
    </script>
</body>
</html>
